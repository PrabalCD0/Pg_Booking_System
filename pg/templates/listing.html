{% extends 'base.html' %}
{% load static %}

{% block style %}
<style>
  .hero-header {
    background-image: url('{% static "bg-hero.jpg" %}');
    color: blue;
  }
 {% comment %} *{
    margin:0;
    pading:0;
    box-sizing:border-box;
    font-family: 'poppins',sans-serif;

 } {% endcomment %}
 .container{
  padding:0 7%;
  width: 100%;
  padding: 0 2%;
 } 

 .list-container{
  margin-top:50px;
  display:flex;
  flex-wrap: wrap;
  justify-content: space-between;


 } 
 .left-col{
  flex-basis: 70%;
}
.right-col{
  flex-basis: 25%;
}
.left-col h1{
  color:#333;
  font-weight: 600;
  margin-bottom: 30px;

}

.house{
  display:flex;
  justify-content: space-between;
  flex-wrap: wrap;
  padding: 10px 0;
  border-top: 1px solid #ccc;

}
.house-img{
  flex-basis: 40%;
  position: relative;
  width: 300px;
  height: 200px;
  overflow: hidden;

}

.house-info{
  flex-basis: 58%;
  font-family: 'Poppins', sans-serif; /* Change the font family */
  color: #333;

}
.house-img img{
 width:100%;
 border-radius: 12px;


}
.house-info p {
  color: ##380957; /* Change the paragraph text color */
}
.guest-info p {
  font-weight: 500;
  color: #555; /* Change the guest info text color */
}
.house-info h3{
  font-weight:600;
  font-size: 22px;
  margin:4px 0;
  margin: 4px 0;
  color: #555; 

}
.house-price{
 text-align: right;
 display: flex;
 align-items: center;
 justify-content: space-between;


}
.price-button h4 {
  font-size: 24px;
  font-weight: 600;
  color: #662a3f; /* Change the price color */
}

.price-button span {
  font-size: 14px;
  font-weight: 500;
  color: #777; /* Change the /month color */
}

.btn-primary {
  background-color: #007bff; /* Change the button background color */
  color: #fff; /* Change the button text color */
  text-decoration: none;
  padding: 10px 20px;
  border-radius: 5px;
  font-weight: 500;
}

.btn-primary:hover {
  background-color: #0056b3; /* Change the button background color on hover */
}
.house-price h4{
  font: size 20px;
  margin: 0;
}
.house-price h4 span{
  font: size 10px;
  font-weight:500 ;
}
.sidebar{
  border: 1px solid #999;
  padding: 20px 30px;
  margin-top: 30px;
}
.sidebar h3{
  font-weight: 500;
}
.sidebar h4{
  font-weight: 500;
  margin: 30px 0 10px;
}
.filter{
  display: flex;
  align-items: center;

  color: #555;
  
  align-items: center;
  margin-bottom: 3px;

}
.filter p{
  flex:1;
}
.filter input{
  margin-right: 15px;
  cursor: pointer;
}
.sidebar-link{
  text-align: right;
  margin: 20px 0;

}
.sidebar-link a{
  text-decoration: none;
}
.pagination{
  display:flex;
  align-items: center;
  justify-content: center;
  margin: 40px 0;
}
.pagination img{
  width: 15px;
  margin: 10px 20px;

}
.pagination span {
  margin:10px 8px;
  width: 40px;
  height:40px;
  line-height: 40px;
  text-align: center;
  border-radius: 50%;
  cursor: pointer;
}
.pagination .current{
  background: #333;
  color: #fff;

}
/* smaller screen for listing page */
@media only screen and (max-width: 700px) {
  .list-container {
    margin-top: 50px;
    flex-direction: column;
  }

  .left-col,
  .right-col,
  .house-img,
  .house-info {
    flex-basis: 100%;
  }
}

/* Change the color of the person icon and guest text inside the <p> tag */
.guest-info p {
    color: #ff0000; /* Replace with your desired color */
}

/* Change the color of the person icon specifically */
.guest-info p i.fas.fa-user {
    color: #00ff00; /* Replace with your desired color */
}
.search-bar {
  display: flex;
  justify-content: flex-end; /* Align the search bar to the right */
  margin-top: 20px; /* Adjust the margin as needed */
}
.options-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

/* Style for the search button within the options bar */
.options-bar .btn-primary {
  background-color: #007bff; /* Change the button background color */
  color: #fff; /* Change the button text color */
  border: none;
  border-radius: 5px;
  font-weight: 500;
}

/* Style the button on hover */
.options-bar .btn-primary:hover {
  background-color: #0056b3; /* Change the button background color on hover */
}

/* Text input */
.search-bar input[type="text"] {
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 5px;
  margin-right: 10px; /* Adjust the margin between input and button */
  width: 250px; /* Adjust the width as needed */
  font-size: 16px; /* Adjust the font size as needed */
}

/* Search button */
.search-bar button[type="submit"] {
  padding: 10px 20px;
  background-color: blue; /* Change the button background color (red in this example) */
  color: #fff;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  font-size: 16px;
}

/* Style the button on hover */
.search-bar button[type="submit"]:hover {
  background-color: blue; /* Change the button background color on hover */
}
.house-price a.btn {
  margin-left: 10px; /* Adjust the margin between the <h4> and <a> */
}
.price-button {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.carousel-control-prev-icon,
  .carousel-control-next-icon {
    background-color: black; 
  }
{% comment %} responsive {% endcomment %}


</style>
    
{% endblock style %}



{% block script %}
<script src="{% static 'js/bootstrap.min.js' %}"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script>
  // Initialize all carousels on the page
  var carousels = document.querySelectorAll('.carousel');
  carousels.forEach(function (carousel) {
      new bootstrap.Carousel(carousel);
  });

  
  /*Ajax Implementation*/
    document.addEventListener('DOMContentLoaded', function () {
        document.getElementById('applyFilters').addEventListener('click', function () {
            // Get filter values
            const gentsFilter = document.getElementById('gentsFilter').checked ? 'male' : null;
            const ladiesFilter = document.getElementById('ladiesFilter').checked ? 'female' : null;
            const unisexFilter = document.getElementById('unisexFilter').checked ? 'unisex' : null;
            const housekeepingFilter = document.getElementById('housekeepingFilter').checked ? 'House Keeping' : null;
            const acFilter = document.getElementById('acFilter').checked ? 'AC' : null;
            const balconyFilter = document.getElementById('balconyFilter').checked ? 'Balcony' : null;
            const kitchenFilter = document.getElementById('kitchenFilter').checked ? 'Kitchen' : null;
            const mineralWaterFilter = document.getElementById('mineralWaterFilter').checked ? 'Mineral Water' : null;
            const rentUnder5000 = document.getElementById('rentUnder5000').checked ? { min: 0, max: 5000 } : null;
            const rent5000to7000 = document.getElementById('rent5000to7000').checked ? { min: 5000, max: 7000 } : null;
            const rent7000to10000 = document.getElementById('rent7000to10000').checked ? { min: 7000, max: 10000 } : null;
            const rentOver10000 = document.getElementById('rentOver10000').checked ? { min: 10000, max: Infinity } : null;
            const filterData = {
                gentsFilter,
                ladiesFilter,
                unisexFilter,
                housekeepingFilter,
                acFilter,
                balconyFilter,
                kitchenFilter,
                mineralWaterFilter,
                rentUnder5000,
                rent5000to7000,
                rent7000to10000,
                rentOver10000,
            };
    
            // Create XMLHttpRequest object
            const xhttp = new XMLHttpRequest();
            const url = '/pgfilter'; // Configure it as a POST request to /pgfilter
            xhttp.open("POST", url, true);
    
            // Get the CSRF token from the cookie
            const csrftoken = getCookie('csrftoken');
            xhttp.setRequestHeader('X-CSRFToken', csrftoken);
            xhttp.setRequestHeader('Content-Type', 'application/json');
    
            xhttp.onreadystatechange = function () {
                if (xhttp.readyState == 4 && xhttp.status == 200) {
                    const responseData = JSON.parse(xhttp.responseText);
                    const pgListingsContainer = document.getElementById('pgListings'); // Assuming you have a container div with the id 'pgListings'
    
                    // Intermediate variable to store HTML content
                    let pgListingsHTML = '';
    
                    if (responseData.length > 0) {
                        responseData.forEach(pg => {
                            const pgHtml = `
                            <div class="house">
                              <div class="house-img">
                                  <div id="carouselExampleControls${pg.id}" class="carousel slide" data-bs-ride="carousel">
                                      <div class="carousel-inner" data-bs-interval="200">
                                          <div class="carousel-item active">
                                              <img src="${pg.property_image1}" class="d-block w-100" alt="...">
                                          </div>
                                          <div class="carousel-item">
                                              <img src="${pg.property_image2}" class="d-block w-100" alt="...">
                                          </div>
                                          <div class="carousel-item">
                                              <img src="${pg.property_image3}" class="d-block w-100" alt="...">
                                          </div>
                                      </div>
                                      <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls${pg.id}" data-bs-slide="prev">
                                          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                          <span class="visually-hidden">Previous</span>
                                      </button>
                                      <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls${pg.id}" data-bs-slide="next">
                                          <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                          <span class="visually-hidden">Next</span>
                                      </button>
                                  </div>
                              </div>
                              
                              <div class="house-info">
                                  <p style="color: darkgoldenrod;">Private pg ${pg.id}</p>
                                  <h3 style="color: #0056b3;">${pg.pgname}</h3>
                                  <p style="color: #007bff; padding: 0%; margin: 0%;">Location: <span style="color: blueviolet; padding: 0%;margin: 0%;">${pg.city},${pg.state},${pg.location}</span></p>
                                  <p style="color: #007bff; padding: 0%; margin: 0%;">Amenities: <span style="color: blueviolet; padding: 0%;margin: 0%;">${pg.amenities}</span></p>
                                  <div class="guest-info">
                                      <p><i class="fas fa-user"></i> ${pg.no_of_beds} Guest</
                                      </p>
                                    </div>
                                    <div class="price-info">
                                        <div class="price-button">
                                            <a href="show_pg/${pg.id}" class="btn btn-primary">View PG Details</a>
                                            <h4>Rs.${pg.rent} <span>/month</span></h4>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            `;
    
                            // Append the HTML content to the pgListingsHTML variable
                            pgListingsHTML += pgHtml;
                        });
    
                        // Set the HTML content of the pgListingsContainer
                        pgListingsContainer.innerHTML = pgListingsHTML;
                    } else {
                        // Handle the case where no results are found
                        pgListingsContainer.innerHTML = '<h4 style="color: #777;">No results found.</h4>';
                    }
                }
            };
    
            // Convert filterData to JSON and send it in the request body
            xhttp.send(JSON.stringify(filterData));
        });
    
        // Helper function to get the value of a cookie by name
        function getCookie(name) {
            const value = `; ${document.cookie}`;
            const parts = value.split(`; ${name}=`);
            if (parts.length === 2) return parts.pop().split(';').shift();
        }
    });
    
          
     


  
{% endblock script %}
{% block div %}
   <a href="home" class="nav-item nav-link">Home</a>
    <a href="about" class="nav-item nav-link">About</a>
    <a href="service" class="nav-item nav-link">Services</a>
    <a href="pgowner_login" class="nav-item nav-link">Pg Owner</a>
    <a href="contact" class="nav-item nav-link">Contact</a>

{% endblock div %}
{% block hero %}
<div class="container-fluid bg-primary py-5  hero-header">
            
</div>
        
{% endblock hero %}

{% block body %}

<div class="container">
  
    <div class="list-container">
        <div class="left-col">
          <div class="options-bar">
            <h3 style="color: blueviolet;">200+ Option</h3>
            <div class="search-bar" style="color: #00ff00;">
                <form action="pg_search" method="GET">
                    <input type="text" name="search" id="search" placeholder="Enter City,State,location">
                    <button type="submit" class="btn btn-primary">Search</button>
                </form>
            </div>
          </div>
            <h1>Recommended Place In India</h1>
      <div id="pgListings">  
        {% if pg_listings %}
        {% for pg in pg_listings %}
        
            <div class="house">
                <div class="house-img">
                    <div id="carouselExampleControls{{pg.id}}" class="carousel slide" data-bs-ride="carousel">
                        <div class="carousel-inner" data-bs-interval="200">
                          <div class="carousel-item active">
                            <img src="{{ pg.property_image1.url }}" class="d-block w-100" alt="...">
                          </div>
                          <div class="carousel-item">
                            <img src="{{ pg.property_image2.url }}" class="d-block w-100" alt="...">
                          </div>
                          <div class="carousel-item">
                            <img src="{{ pg.property_image3.url }}" class="d-block w-100" alt="...">
                          </div>
                        </div>
                        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls{{pg.id}}" data-bs-slide="prev">
                          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                          <span class="visually-hidden">Previous</span>
                        </button>
                        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls{{pg.id}}" data-bs-slide="next">
                          <span class="carousel-control-next-icon" aria-hidden="true"></span>
                          <span class="visually-hidden">Next</span>
                        </button>
                      </div>
                </div>
                
                <div class="house-info">
                  <p style="color: darkgoldenrod;">Private pg {{pg.id}}</p>
                  <h3 style="color: #0056b3;">{{ pg.pgname }}</h3>
                  <p  style="color: #007bff; padding: 0%; margin: 0%;">Location: <span style="color: blueviolet; padding: 0%;margin: 0%;">{{ pg.city}},{{ pg.state}},{{pg.location}}</span></p>
                  <p  style="color: #007bff; padding: 0%; margin: 0%;">Amenities: <span style="color: blueviolet; padding: 0%;margin: 0%;">{{ pg.amenities}}</span></p>
                  <div class="guest-info">
                    <p><i class="fas fa-user"></i> {{ pg.no_of_beds }} Guest</p>
                  </div>
                  <div class="price-info">
                      <div class="price-button">
                          <a href="show_pg/{{pg.id}}"  class="btn btn-primary">View PG Details</a>
                          <h4>Rs.{{ pg.rent }} <span>/month</span></h4>
                          
                      </div>
                  </div>
                </div>
            </div>
            {% comment %} {% endif %}
            
            {% endfor %} {% endcomment %}
            {% endfor %}
            {% else %}
            <h4 style="color: #777;">No results found.</h4>
             {% endif %}
    


            {% comment %} room listing {% endcomment %}
            
          </div>        
        </div>
        {% comment %} <div id="pgListings"></div> {% endcomment %}
        <div class="right-col">
            <div class="sidebar">
                <h3>Select Filters</h3>
                <h5 style="font-weight: 500; margin: 15px 0 10px;">Gender</h5>
                <div class="filter">
                  <label><input type="checkbox"  id="gentsFilter"> Gents</label>
                </div>
                <div class="filter">
                   <label><input type="checkbox" id="ladiesFilter"> Ladies</label>
                </div>
                <div class="filter">
                   <label><input type="checkbox" id="unisexFilter"> Unisex</label>
                </div>
                
              <!-- Monthly Rent Filters -->
                <h5 style="font-weight: 500; margin: 15px 0 10px;">Monthly Rent</h5>
                <div class="filter-checkbox">
                  <label><input type="checkbox" id="rentUnder5000" data-min="0" data-max="5000"> < 5000</label>
              </div>
              <div class="filter-checkbox">
                  <label><input type="checkbox" id="rent5000to7000" data-min="5000" data-max="7000"> 5000 - 7000</label>
              </div>
              <div class="filter-checkbox">
                  <label><input type="checkbox" id="rent7000to10000" data-min="7000" data-max="10000"> 7000 - 10000</label>
              </div>
              <div class="filter-checkbox">
                  <label><input type="checkbox" id="rentOver10000" data-min="10000" data-max="Infinity"> > 10000</label>
              </div>
              

                {% comment %} <div class="sidebar-link">
                    <a href="#">View More</a>
                </div>
                 {% endcomment %}


                 <h5 style="font-weight: 500; margin: 15px 0 10px;">Amenities</h5>
                 <div class="filter-checkbox">
                     <label><input type="checkbox" id="housekeepingFilter"> Housekeeping</label>
                 </div>
                 <div class="filter-checkbox">
                     <label><input type="checkbox" id="acFilter"> AC</label>
                 </div>
                 <div class="filter-checkbox">
                     <label><input type="checkbox" id="balconyFilter"> Balcony</label>
                 </div>
                 <div class="filter-checkbox">
                     <label><input type="checkbox" id="kitchenFilter"> Kitchen</label>
                 </div>
                 <div class="filter-checkbox">
                     <label><input type="checkbox" id="mineralWaterFilter"> Mineral Water</label>
                 </div>
                <div class="sidebar-link" style="text-align: left;">
                  <button type="button" id="applyFilters" class="btn btn-primary" style="background-color: darkgreen; color: #FFFFFF; padding: 5px 10px; font-size: 14px;">Apply</button>
              </div>
              
            </div>
            
            
        </div>
    </div>

    <div class="pagination">
        <img src="{% static 'img/package-3.jpg' %}" alt="">
        <span class="current">1</span>
        <span>2</span>
        <span>3</span>
        <span>4</span>
        <span>&middot &middot &middot &middot</span>
        <span>20</span>


        <img src="{% static 'img/package-3.jpg' %}" alt="">
    </div>
</div> 



{% endblock body %}